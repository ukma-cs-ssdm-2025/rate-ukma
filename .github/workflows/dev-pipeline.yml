name: Dev Pipeline
on:
  pull_request:

jobs:
  test:
    uses: ./.github/workflows/test.yml

  openapi-validation:
    uses: ./.github/workflows/openapi-validation.yml

  audit:
    uses: ./.github/workflows/audit.yml
    with:
      SAFETY_API_KEY: ${{ secrets.SAFETY_API_KEY }}
    secrets: inherit

  build:
    needs: [test, openapi-validation, audit]
    uses: ./.github/workflows/build.yml
    with:
      profile: "prod"