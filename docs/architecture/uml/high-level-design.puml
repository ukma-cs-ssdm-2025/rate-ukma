@startuml high-level-architecture
title Rate UKMA â€“ High-Level Architecture (v1.0)

skinparam componentStyle rectangle
skinparam packageStyle  rectangle

package "Presentation Layer" {
  [Web Frontend (SPA)] as WebApp
}

package "Edge Layer" as EDGE {
  interface "REST API (OpenAPI v3)" as REST
  [Authentication Middleware] as Auth
}

package "Business Logic Layer" as BL {
  [Course Service]          as CourseSvc
  [Rating Service]          as RatingSvc
  [User Service]            as UserSvc
  [Recommendation Service]  as RecoSvc
  [Scraper Service]         as ScraperSvc

  RatingSvc --> CourseSvc
  RatingSvc --> UserSvc
  RecoSvc   --> RatingSvc
  RecoSvc   --> CourseSvc
  RecoSvc   --> UserSvc
  ScraperSvc --> CourseSvc
  ScraperSvc --> UserSvc
}

package "Data Access Layer" {
  [Course Repository]   as CourseRepository
  [Rating Repository]   as RatingRepository
  [User Repository]     as UserRepository
  [Scraper Repository]  as ScraperRepository
}

package "Data Layer" {
  database "PostgreSQL" as MainDB
  [File Storage] as FileStore
}

package "External Systems" {
  [Microsoft OIDC Identity Provider] as OIDC
  [my.ukma.edu.ua (University Portal)] as UkmaPortal
}

CourseSvc   --> CourseRepository
RatingSvc   --> RatingRepository
UserSvc     --> UserRepository
ScraperSvc  --> ScraperRepository

WebApp --> REST
REST ..> Auth : session cookie + CSRF
REST --> CourseSvc
REST --> RatingSvc
REST --> UserSvc
REST --> RecoSvc
Auth --> OIDC

CourseRepository   --> MainDB
RatingRepository   --> MainDB
UserRepository     --> MainDB
ScraperRepository  --> FileStore

ScraperSvc --> UkmaPortal : scrape course & enrollment data

@enduml
