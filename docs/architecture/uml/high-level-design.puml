@startuml
title Rate UKMA – High-Level Architecture (v1.0)

skinparam componentStyle rectangle
skinparam packageStyle  rectangle

'───────────── Presentation ─────────────
package "Presentation Layer" {
  [Web Frontend (SPA)] as WebApp
}

'───────────── Backend Boundary ─────────
package "Edge Layer" as EDGE {
  interface "REST API (OpenAPI v3)" as REST
  [Authentication Middleware] as Auth
}

'───────────── Business Logic ───────────
package "Business Logic Layer" as BL {
  [Course Service]          as CourseSvc
  [Rating Service]          as RatingSvc
  [User Service]            as UserSvc
  [Recommendation Service]  as RecoSvc
  [Scraper Service]         as ScraperSvc

  RatingSvc --> CourseSvc
  RatingSvc --> UserSvc
  RecoSvc   --> RatingSvc
  RecoSvc   --> CourseSvc
}

'───────────── Data-Access Layer ────────
package "Data Access Layer" {
  [ORM] as ORM
}

'───────────── Data Layer ───────────────
package "Data Layer" {
  database "PostgreSQL" as MainDB
  [File Storage] as FileStore
}

'───────────── External Systems ─────────
package "External Systems" {
  [Microsoft OIDC Identity Provider] as OIDC
}

'───────────── Flows ────────────────────
WebApp --> REST
REST ..> Auth : session cookie + CSRF
REST --> CourseSvc
REST --> RatingSvc
REST --> UserSvc
REST --> RecoSvc
Auth --> OIDC

CourseSvc --> ORM
RatingSvc --> ORM
UserSvc   --> ORM
ORM --> MainDB

ScraperSvc --> FileStore
ScraperSvc --> CourseSvc
@enduml
